input {
 udp {
  port => 514
  type => "udp"
 }
}

filter {
 grok {
  type => "udp"
  patterns_dir => [ "/etc/logstash/files/patterns" ]
  match => [ "message", "<%{NONNEGINT:priority}>%{SYSLOGTSPIX:timestamp} %{HOSTNAME:hostname} : %(%{WORD:app}|-)-(%{WORD:proc}|-)-(%{WORD:msgid}|-):%{WORD:action} %{WORD:protocol} src %{WORD:src_interface}:%{IP:src_ip}(/|///)%{NONNEGINT:src_port} dst %{WORD:dst_interface}:%{IP:dst_ip}(/|//)%{NONNEGINT:dst_port} by access-group %{QUOTEDSTRING:access_group}(%{GREEDYDATA:flags})" ]
  match => [ "message", "<%{NONNEGINT:priority}>%{SYSLOGTSPIX:timestamp} %{HOSTNAME:hostname} : %(%{WORD:app}|-)-(%{WORD:proc}|-)-(%{WORD:msgid}|-):%{GREEDYDATA:message}" ]
  overwrite => [ "message" ]
  add_tag => [ "syslog" ]
 }
 
}

output {
 elasticsearch {
  host => "log-01.datacentre.esendex.com"
  type => "udp"
 }
}

